{"ast":null,"code":"// UploadDraw.jsx — Updated to parse your May 2025 draw CSV correctly\nimport{useState}from\"react\";import{useTournament}from\"../context/TournamentContext\";import Papa from\"papaparse\";import{collection,addDoc,Timestamp}from\"firebase/firestore\";import{db}from\"../firebase\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UploadDraw(){const[file,setFile]=useState(null);const[status,setStatus]=useState(\"\");const{currentTournament}=useTournament();const handleUpload=async()=>{if(!file)return;setStatus(\"Parsing CSV...\");Papa.parse(file,{header:true,complete:async results=>{const data=results.data;let successCount=0;try{for(let row of data){if(!row.date||!row.time||!row.court||!row.division||!row.teams||!row.umpire)continue;const parsedDate=new Date(row.date);console.log(\"Parsed date:\",parsedDate);if(!(parsedDate instanceof Date)||isNaN(parsedDate.getTime())){// Invalid date, skip this row\ncontinue;}const match={date:Timestamp.fromDate(parsedDate),time:row.time,court:row.court,division:row.division,teams:row.teams,umpire:row.umpire.trim()};if(!currentTournament){setStatus(\"❌ No tournament selected.\");return;}await addDoc(collection(db,`tournaments/${currentTournament}/matches`),match);successCount++;}setStatus(`✅ Uploaded ${successCount} matches.`);}catch(err){console.error(err);setStatus(\"❌ Error during upload.\");}},error:error=>{console.error(\"CSV Parse Error:\",error);setStatus(\"❌ Failed to parse CSV.\");}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-2\",children:\"Upload Match Draw\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".csv\",onChange:e=>setFile(e.target.files[0]),className:\"mb-2\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-600 text-white px-4 py-2 rounded\",onClick:handleUpload,children:\"Upload\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-gray-700 dark:text-gray-200\",children:status})]});}","map":{"version":3,"names":["useState","useTournament","Papa","collection","addDoc","Timestamp","db","jsx","_jsx","jsxs","_jsxs","UploadDraw","file","setFile","status","setStatus","currentTournament","handleUpload","parse","header","complete","results","data","successCount","row","date","time","court","division","teams","umpire","parsedDate","Date","console","log","isNaN","getTime","match","fromDate","trim","err","error","className","children","type","accept","onChange","e","target","files","onClick"],"sources":["/Users/andrewhall-villiers/Downloads/match-report-app-final-complete/src/pages/UploadDraw.jsx"],"sourcesContent":["// UploadDraw.jsx — Updated to parse your May 2025 draw CSV correctly\n\nimport { useState } from \"react\";\nimport { useTournament } from \"../context/TournamentContext\";\nimport Papa from \"papaparse\";\nimport { collection, addDoc, Timestamp } from \"firebase/firestore\";\nimport { db } from \"../firebase\";\n\nexport default function UploadDraw() {\n  const [file, setFile] = useState(null);\n  const [status, setStatus] = useState(\"\");\n  const { currentTournament } = useTournament();\n\n  const handleUpload = async () => {\n    if (!file) return;\n    setStatus(\"Parsing CSV...\");\n\n    Papa.parse(file, {\n      header: true,\n      complete: async (results) => {\n        const data = results.data;\n        let successCount = 0;\n        try {\n          for (let row of data) {\n            if (!row.date || !row.time || !row.court || !row.division || !row.teams || !row.umpire) continue;\n\n            const parsedDate = new Date(row.date);\n            console.log(\"Parsed date:\", parsedDate);\n            if (!(parsedDate instanceof Date) || isNaN(parsedDate.getTime())) {\n              // Invalid date, skip this row\n              continue;\n            }\n            const match = {\n              date: Timestamp.fromDate(parsedDate),\n              time: row.time,\n              court: row.court,\n              division: row.division,\n              teams: row.teams,\n              umpire: row.umpire.trim(),\n            };\n            \n            if (!currentTournament) {\n              setStatus(\"❌ No tournament selected.\");\n              return;\n            }\n\n            await addDoc(collection(db, `tournaments/${currentTournament}/matches`), match);\n            successCount++;\n          }\n          setStatus(`✅ Uploaded ${successCount} matches.`);\n        } catch (err) {\n          console.error(err);\n          setStatus(\"❌ Error during upload.\");\n        }\n      },\n      error: (error) => {\n        console.error(\"CSV Parse Error:\", error);\n        setStatus(\"❌ Failed to parse CSV.\");\n      }\n    });\n  };\n\n  return (\n    <div className=\"p-4\">\n      <h2 className=\"text-xl font-bold mb-2\">Upload Match Draw</h2>\n      <input type=\"file\" accept=\".csv\" onChange={(e) => setFile(e.target.files[0])} className=\"mb-2\" />\n      <button\n        className=\"bg-blue-600 text-white px-4 py-2 rounded\"\n        onClick={handleUpload}\n      >\n        Upload\n      </button>\n      <p className=\"mt-2 text-sm text-gray-700 dark:text-gray-200\">{status}</p>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}